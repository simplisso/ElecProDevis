<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>√âlecProDevis ‚Äì Produits</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>üì¶ S√©lection des produits</h1>

  <section>
    <div class="grille" id="grilleProduits"></div>
  </section>

  <section>
    <h3>‚ûï Ajouter un produit manuel</h3>
    <label>Nom :
      <input type="text" id="nomManuel">
    </label>
    <label>Prix unitaire HT :
      <input type="number" id="prixManuel">
    </label>
    <label>TVA (%) :
      <input type="number" id="tvaManuel" value="20">
    </label>
    <button onclick="ajouterManuel()">Ajouter</button>
  </section>

  <button onclick="genererDevis()">‚û°Ô∏è G√©n√©rer le devis</button>

  <script src="script.js"></script>
  <script>
    const produits = [
      { nom: "Piquet de terre", prix: 1500, tva: 18, image: "images/piquet.png" },
      { nom: "Bo√Æte de d√©rivation", prix: 800, tva: 18, image: "images/boite.png" },
      { nom: "C√¢ble 3G2.5", prix: 1200, tva: 18, image: "images/cable.png" },
      { nom: "Gaine ICTA", prix: 500, tva: 18, image: "images/gaine.png" },
      { nom: "Tableau √©lectrique", prix: 7500, tva: 18, image: "images/tableau.png" },
      { nom: "Disjoncteur 16A", prix: 1800, tva: 18, image: "images/disjoncteur.png" },
      { nom: "Prise murale", prix: 1000, tva: 18, image: "images/prise.png" },
      { nom: "Bo√Ætier encastr√©", prix: 600, tva: 18, image: "images/boitier.png" }
    ];

    const selection = [];

    function afficherGrille() {
      const grille = document.getElementById("grilleProduits");
      produits.forEach((p, index) => {
        const div = document.createElement("div");
        div.className = "produit";
        div.innerHTML = `
          <img src="${p.image}" alt="${p.nom}">
          <span>${p.nom}</span>
          <label>Quantit√© :
            <input type="number" id="qte${index}" min="0" value="0">
          </label>
        `;
        grille.appendChild(div);
      });
    }

    function ajouterManuel() {
      const nom = document.getElementById("nomManuel").value.trim();
      const prix = parseFloat(document.getElementById("prixManuel").value);
      const tva = parseFloat(document.getElementById("tvaManuel").value);
      if (!nom || isNaN(prix) || isNaN(tva)) {
        alert("Remplis tous les champs du produit manuel.");
        return;
      }
      selection.push({ nom, prix, tva, quantite: 1 });
      alert("‚úÖ Produit manuel ajout√© !");
    }

    function genererDevis() {
      produits.forEach((p, index) => {
        const qte = parseInt(document.getElementById("qte" + index).value);
        if (qte > 0) {
          selection.push({ ...p, quantite: qte });
        }
      });
      if (selection.length === 0) {
        alert("Ajoute au moins un produit.");
        return;
      }
      localStorage.setItem("produits", JSON.stringify(selection));
      const paiementValide = localStorage.getItem("paiementValide") === "true";
      window.location.href = paiementValide ? "personnalisation.html" : "paiement.html";
    }

    afficherGrille();
  </script>
</body>
</html>
